!function(e){e.fn.moreInfoPopup=function(o,r,n){var t=e.extend(!0,{},e.fn.moreInfoPopup.defaults,n),p=this;t._wrapper="."+t.wrapper,t._arrow="."+t.arrow,t._body="."+t.body,t._content="."+t.content,t._active="."+t.active;var a=function(e,o){return e.outerHeight()+(e.offset().top-o.offset().top)},i=function(){t.$wrapper=e(t._wrapper),t.$arrow=e(t._arrow),t.$body=e(t._body),t.$content=e(t._content),t.$onClickSelector=e(o)},c=function(){t.timeline=new TimelineMax({paused:!0,onReverseComplete:function(){t.$wrapper.css("top",0),t.$wrapper.removeData("rowIndex")}}).fromTo(t.$wrapper,t.animation.speed,t.animation.from,t.animation.to)},s=function(){p.prepend(e("<div/>",{class:t.wrapper}).append(e("<div/>",{class:t.arrow})).append(e("<div/>",{class:t.body}).append(e("<p/>",{class:t.content}))))};return p.on("click.moreInfoPopup",o,function(n){var i=r.call(this),c=a(e(this),p);if(t.$wrapper.data("rowIndex",e(this).index(o)),parseFloat(t.$wrapper.css("top"))===c||!i.length)return t.$onClickSelector.removeClass(t.active),void t.timeline.reverse();t.$onClickSelector.removeClass(t.active),e(this).addClass(t.active),t.$wrapper.css("top",c+"px"),t.$content.html(i.html()),t.timeline.restart(),n.stopPropagation(),e(document).one("click",function(r){e(r.target).is(o)||(t.$onClickSelector.removeClass(t.active),t.timeline.reverse())})}),e(window).on("resize.moreInfoPopup",function(){if(void 0!==(rowIndex=t.$wrapper.data("rowIndex"))){var r=e(o).eq(rowIndex),n=a(r,p);parseFloat(t.$wrapper.css("top"))!==n&&t.$wrapper.css("top",n+"px")}}),function(){p.find(t._wrapper).length||s(),i(),c()}(),this},e.fn.moreInfoPopup.defaults={wrapper:"more-info-popup",arrow:"more-info-popup__arrow",body:"more-info-popup__body",content:"more-info-popup__content",active:"more-info-popup_active",animation:{speed:.3,from:{yPercent:-20,autoAlpha:0},to:{yPercent:0,autoAlpha:1}}}}(jQuery);
